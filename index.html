// Function to upload file using the pre-signed URL
function uploadFile(file, presignedUrl) {
    const xhr = new XMLHttpRequest();
    xhr.open("PUT", presignedUrl, true); // Open a PUT request using the pre-signed URL
    
    // Set headers for the file upload
    xhr.setRequestHeader("Content-Type", file.type); // Use the MIME type of the file
    xhr.setRequestHeader("x-amz-acl", "public-read");

    // Handle upload response
    xhr.onload = function () {
        if (xhr.status === 200) {
            alert("File uploaded successfully! File URL: " + presignedUrl.split('?')[0]);
        } else {
            alert("Upload failed. Status: " + xhr.status);
        }
    };

    xhr.onerror = function () {
        alert("Upload failed due to an error.");
    };

    xhr.send(file); // Send the file to S3 using the pre-signed URL
}

// Add event listener to the upload button
const uploadButton = document.getElementById('uploadButton');
uploadButton.onclick = function () {
    const fileInput = document.getElementById('fileInput');
    const file = fileInput.files[0];

    if (file && presignedUrl) {
        uploadFile(file, presignedUrl);
    } else {
        alert("No file selected or pre-signed URL is missing.");
    }
};

